language: csharp

dotnet: 3.0

solution: EventDispatcher.sln

jobs: 
  include:
    - stage: compile
      script:
        - dotnet restore
        - dotnet build
        - dotnet test ./*Test*/*.csproj
    - stage: deploy
      script:
        - dotnet build -c Release
        - dotnet pack ./GlobalElements.EventDispatcher/GlobalElements.EventDispatcher.csproj -c Release -p:NuspecFile=EventDispatcher.nuspec
        - dotnet nuget push bin\Release\*.nupkg
          
stages:
  - compile
  - name: deploy
    if: branch = master

global:
  - DOTNET_SKIP_FIRST_TIME_EXPERIENCE=true
  - DOTNET_CLI_TELEMETRY_OPTOUT=1
